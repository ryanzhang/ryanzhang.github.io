---
layout: post
title:  "在家里搭建你的PaaS-打通VPN网络"
date:   2020-12-13
desc: ""
keywords: "联通, Openshift4, kvm, openvpn"
categories: [Work]
tags: [paas, test]
icon: icon-html
---
在家里搭建您的私有云第一步是打通网络;

# 从互联网如何访问到你的家里内网

```
  ||         互联网
  \/  (openvpn)
============ 路由器(端口转换)
  家里局域网

  (KVM VM)

============
````
* 第一步，打电话给联通，要求分配公网IP

  默认你搜索到的"我的IP" 非公网IP；通过该IP无法访问到你家的路由器；虽然可以Ping通；
* 第二步: 光猫改桥接模式
  
  现在基本上都是光纤，光猫入户；所以家里宽带一般都是是通过光猫上网；拨号有两种方式， 这里我们需要使用第二种方式:
  * 1 光猫拨号 (联通默认)
  ```
  [联通光猫(后面插了一个光纤的)](a.拨号) ==(wlan口网线直连)==》[路由器(就是wifi)](b.通过dhcp上网)
  ```
  光猫其实就是联通自带的一个路由器，具备拨号，以及wifi功能，而且是免费的；主要的问题是它路由功能弱，比不了自己买的路由器，这就是为什么我们都会自己买路由器，因为wifi信号太差；像端口转发这些功能，联通技术支持自己也不推荐我们使用；
  但是它能够接入光纤，这是普通路由器没有的接口；

  默认安装就是后面接一个家用路由器，提供wifi功能；

  如果要实现端口转发(曰NAT，即从互联网ip 访问内网的一个机器服务)，一种推荐的方式就是让路由器自己拨号；

  光猫可以拨号；路由器也可以拨号；如果通过路由器拨号，就叫做桥接; 和联通客服沟通就说“我要改桥接模式". 他们就会给你在**服务器端设置**(不需要上门)；然后你就可以在路由器上输入ppoe的用户名+密码拨号了，就是这里 第2 的方式

  
  * 2 路由器直接拨号
  
  这种方式就是要取得你自己的联通宽带帐户，在路由器上网设置中输入:用户名 + 密码；
  密码忘记了不要紧，找联通技术支持就可以；联通差不多每个小区都有专属技术支持；服务相当好并且免费；

  查询自己的ip: curl ifconfig.co
  测试端口网站: http://tool.chinaz.com/port/
  测速网站: https://www.speedtest.cn/
  (联通宽带单位都是mbps,比如500M带宽，指的就是500mbps, 转换为我们的字节数大小要除8， 测速网站也都是以mbps单位计量；如果你发现你家里的测速 比购买的带宽相差很多，那很有可能是路由器的问题；)

  光猫改桥接方式 就是通过路由器拨号上网；这不会影响拨号上网的效率；如果速度下降 说明路由器有问题，或者太老了；

* 配置端口转发(NAT)

  路由器上一般都有三个功能
  * 静态配置 单个端口 转发；
  * 虚拟主机 配置内网主机的端口范围；
  * DMZ 把单个机器所有的端口 暴露给互联网；


这里建议就是给你的一台24小时开机的主机 配置Openvpn服务，并且把openvpn的服务端口 映射除去；

